
<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org">
<head>
  <title>Medicine Order Form</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <style>
    .container {
      margin-top: 50px;
    }
    h2 {
      text-align: center;
      margin-bottom: 30px;
    }
    .medicine-section {
      border: 1px solid #ccc;
      padding: 20px;
      margin-bottom: 20px;
    }
    .medicine-section h4 {
      margin-top: 0;
    }
    .btn-remove {
      margin-top: 10px;
    }
    .btn-submit {
      margin-top: 20px;
    }
  </style>
</head>

<body>
  <div class="container card" >
    <h2>Order medicine</h2>
    <form id="order-form" th:object="${medicine}" th:action="@{/pharmacy/process-order}" method="post">
      <div id="medicine-sections">
        <div class="medicine-section" id="medicine1">
          <h4>Medicine 1</h4>
          
          <div class="form-row">
            <div class="col-md-4">
              <div class="form-group">
                <label for="name1">Medicine Name:</label>
                <input type="text" class="form-control" id="name1" name="name" placeholder="Enter medicine name">
              </div>
            </div>
            <div class="col-md-2">
              <div class="form-group">
                <label for="quantity1">Quantity:</label>
                <input type="number" class="form-control" id="quantity1" name="quantity" placeholder="Enter quantity">
              </div>
            </div>
            <div class="col-md-2">
              <div class="form-group">
                <label for="price1">Price:</label>
                <input type="text" class="form-control" id="price1" name="price" placeholder="Enter price">
              </div>
            </div>
            <div class="col-md-2">
              <div class="form-group">
                <label for="total1">Total:</label>
                <input type="text" class="form-control" id="total1" name="total" >
              </div>
            </div> 
            <div class="col-md-2 align-self-end">
              <button type="button" class="btn btn-danger btn-remove" onclick="removeMedicine(1)">Remove</button>
            </div>
          </div>
        </div>
      </div>

      <button type="button" class="btn btn-primary" onclick="addMedicine()">Add Medicine</button>
      <div id="form-total">Total: Rs. 0.00</div>
      <div class="text-center mt-2 mb-3">
      <button type="submit" class="btn btn-primary btn-submit align-center">Order</button>
       
      </div>
    </form>
  </div>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<!--   
  <script>
    var sectionCounter = 1;

    // Function to add a new medicine section
    function addMedicine() {
      sectionCounter++;

      var newSection = `
        <div class="medicine-section" id="medicine${sectionCounter}">
          <h4>Medicine ${sectionCounter}</h4>
          <div class="form-row">
            <div class="col-md-4">
              <div class="form-group">
                <label for="name${sectionCounter}">Medicine Name:</label>
                <input type="text" class="form-control" id="name${sectionCounter}" name="name[]" placeholder="Enter medicine name">
              </div>
            </div>
            <div class="col-md-2">
              <div class="form-group">
                <label for="quantity${sectionCounter}">Quantity:</label>
                <input type="number" class="form-control" id="quantity${sectionCounter}" name="quantity[]" placeholder="Enter quantity">
              </div>
            </div>
            <div class="col-md-2">
              <div class="form-group">
                <label for="price${sectionCounter}">Price:</label>
                <input type="text" class="form-control" id="price${sectionCounter}" name="price[]" placeholder="Enter price">
              </div>
            </div>
            <div class="col-md-2">
              <div class="form-group">
                <label for="total${sectionCounter}">Total:</label>
                <input type="text" class="form-control" id="total${sectionCounter}" name="total[]" readonly>
              </div>
            </div>
            <div class="col-md-2 align-self-end">
              <button type="button" class="btn btn-danger btn-remove" onclick="removeMedicine(${sectionCounter})">Remove</button>
            </div>
          </div>
        </div>
      `;

      $('#medicine-sections').append(newSection);
    }

    // Function to remove a medicine section
    function removeMedicine(sectionId) {
      $('#medicine' + sectionId).remove();
    }

    // Calculate the total based on quantity and price
    $(document).on('input', 'input[name^="quantity"], input[name^="price"]', function() {
      var section = $(this).closest('.medicine-section');
      var quantity = section.find('input[name^="quantity"]').val();
      var price = section.find('input[name^="price"]').val();
      var total = quantity * price;
      section.find('input[name^="total"]').val(total.toFixed(2));
    });

    // Submit form event handler
    $('#order-form').submit(function(event) {
      event.preventDefault();
      var formData = $(this).serialize();
      console.log(formData);
    });
    
    
    
      // Calculate the total based on quantity and price
  $(document).on('input', 'input[name^="quantity"], input[name^="price"]', function() {
    var section = $(this).closest('.medicine-section');
    var quantity = section.find('input[name^="quantity"]').val();
    var price = section.find('input[name^="price"]').val();
    var total = quantity * price;
    section.find('input[name^="total"]').val(total.toFixed(2));

    // Update the form total
    calculateFormTotal();
  });

// ...

  // Function to remove a medicine section
  function removeMedicine(sectionId) {
    $('#medicine' + sectionId).remove();

    // Update the form total
    calculateFormTotal();
  }

  // Calculate the total based on quantity and price
  $(document).on('input', 'input[name^="quantity"], input[name^="price"]', function() {
    var section = $(this).closest('.medicine-section');
    var quantity = section.find('input[name^="quantity"]').val();
    var price = section.find('input[name^="price"]').val();
    var total = quantity * price;
    section.find('input[name^="total"]').val(total.toFixed(2));

    // Update the form total
    calculateFormTotal();
  });

  // Calculate the total of all medicines in the form
  function calculateFormTotal() {
    var total = 0;
    $('.medicine-section').each(function() {
      var quantity = $(this).find('input[name^="quantity"]').val();
      var price = $(this).find('input[name^="price"]').val();
      var subtotal = quantity * price;
      total += subtotal;
    });

    // Update the form total display
    $('#form-total').text('Total: $' + total.toFixed(2));
  }
  </script> -->
</body>
</html>
